---
title: 네트워크 장비 - 라우터
date: 2024-01-09
categories: ["NETWORK"]
tags: ['networking']     # TAG names should always be lowercase
toc: true
---

## 라우터/L3 스위치 

라우터는 3계층에서 동작하는 네트워크 장비이며, 이름 그 뜻 그대로 경로를 지정해주는 장비이다. 들어오는 패킷의 목적지 IP를 확인한후 자신이 가지고 있는 경로 정보를 이용해서 패킷을 최적의 경로로 포워딩한다. 스위치와는 다르게, 들어온 패킷의 목적지 주소가 자신의 라우팅 테이블에 없으면 패킷을그냥 버린다.

### 경로지정

라우터의 가장 중요한 역할은 경로 지정이다. 경로 정보들을 모아서 라우팅 테이블을 만들고 패킷이 라우터로 들어오면 패킷의 목적지 IP 주소를 확인해 경로를 지정하고 패킷을 포워딩한다. IP주소는 네트워크 주소와 호스트 주소로 나뉘므로, 라우터는 원격과 로컬 네트워크를 구분할 수 있다.

### 브로드캐스트 컨트롤

라우터는 기본적으로 멀티캐스트 정보를 습득하지 않고 브로드캐스트 패킷을 전달하지 않는다. 라우터의 해당 기능을 이용해 브로드캐스트가 다른 네트워크로 전파되는 것을 막을 수 있다. `이러한 기능을 브로드캐스트/멀티캐스트 컨트롤` 이라고 한다.

### 프로토콜 변환

라우터에 패킷이 들어오면 2계층까지의 헤더 정보를 벗겨내고 3계층 주소를 확인한 후, 2계층 헤더 정보를 새로 만들어 외부로 내보낸다. 이를 이용해 헤더를 변경항으로써 프로토콜의 변환이 가능하다.

## 경로지정 - 라우팅/스위칭

라우터는 크게 두가지의 기능이 있다.
1. 경로 정보를 얻어서 경로 정보를 처리
2. 정리된 경로 정보로 패킷을 포워딩

라우터는 정보를 습득하고 라우팅 정보를 최적화하기 위하여 summary 작업을 통해 여러의 서브넷 정보를 뭉쳐서 전달한다. 따라서 라우터에 들어온 패킷의 목적지 주소와 라우터가 갖고 있는 라우팅 테이블 정보가 정확히 일치하지 않더라도 목적지에 가장 근접한 정보를 찾아서 패킷을 포워딩한다.

### 라우팅 동작과 라우팅 테이블

라우터는 패킷이 목적지로 가는 전체 경로를 파악하지 않고 최적의 다음 홉을 찾아서 패킷을 보내준다. 이때 다음 홉을 지정하는 방법은 크게 세가지가 있다.
1. 다음 라우터의 IP를 지정 (기본적인 방법)
2. 라우터의 나가는 인터페이스를 지정
3. 라우터의 나가는 인터페이스와 다음 라우터의 IP를 동시에 지정

### 라우터가 경로 정보를 얻는 방법

1. 다이렉트 커넥티드
라우터 자신이 속한 IP주소를 확인하면 서브넷마스크로 해당 IP주소가 속한 네트워크 주소 정보를 알수 있다. 라우터나 PC에서는 이 정보로 해당 네트워크에 대한 라우팅 테이블을 자동으로 만든다. 이러한 경로 정보를 `다이렉트 커넥티드` 라고 한다.
2. 스태틱 라우팅
관리자가 목적지 네트워크와 넥스트 홉을 라우터에 직접 지정해 경로 정보를 입력하는 것을 `스태틱 라우팅` 이라고 한다.
3. 다이나믹 라우팅
스태틱 라우팅이 간편하긴하지만, 큰 네트워크에서는 일일히 다 입력할수 없다. 다이나믹 라우팅은 라우터끼리 자신이 알고 있는 경로 정보나 링크 상태 정보를 교환해 전체 네트워크 정보를 학습한다.

> 논리 인터페이스의 경우 물리인터페이스가 비활성화 되더라도 함께 비활성화되지 않을 수도 있다.
{: .prompt-warning }

## 스위칭 - 라우터가 경로를 지정하는 방법

패킷이 들어와서 라우팅 테이블을 참조하고 최적의 경로를 찾아 라우터 외부로 포워딩하는 작업을 스위칭이라고 한다.
> 목적지 IP가 라우팅 테이블과 정확히 일치하지 않아도 가지고 있는 경로 정보 중 가장 가까운 경로를 선택하는데 이때 Logest Prefix Match 기법을 사용한다.
{: .prompt-info }
한번 스위칭을 하게 되면 해당 정보를 캐시에 저장하고, 뒤에 들어오는 패킷은 라우팅 테이블을 확인하기전에 캐시를 먼저 확인한다.